{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Mostrar CSV</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="{% static 'css/estilosInicio.css' %}">
    <script>
        {% if messages %}
        window.onload = function() {
            {% for message in messages %}
            alert("{{ message }}");
            {% endfor %}
        }
        {% endif %}
    </script>
</head>

<body>
    <div class="container mt-4">
        <h1 class="mb-4">Columnas seleccionadas para almacenar en la base de datos</h1>

        <div class="d-flex align-items-center mb-4">
            <!-- Formulario para seleccionar el modelo -->
            <form method="post" action="{% url 'insertar_datos' %}" class="form-inline">
                {% csrf_token %}
                {% if tablas %}
                <div class="form-group mr-2">
                    <label for="tabla" class="mr-2">Selecciona una tabla:</label>
                    <select name="tabla" id="tabla" class="form-control">
                        {% for tabla in tablas %}
                        <option value="{{ tabla }}">{{ tabla }}</option>
                        {% endfor %}
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Insertar Datos</button>
                {% else %}
                <p>No hay tablas disponibles.</p>
                {% endif %}
            </form>
            
            <div class="ml-3">
                <a href="{% url 'mostrar_csv' %}" class="btn btn-secondary">Retroceder</button>
                </a>
            </div>
        </div>

        <table class="table table-bordered">
            <thead class="thead-dark">
                <tr>
                    {% for columna, tipo in columnas_con_tipos %}
                    <th>
                        {{ columna }}
                        {% if tipo == 'bool' %}
                        (Tinyint)
                        {% elif tipo == 'int64' %}
                        (Integer)
                        {% elif tipo == 'float64' %}
                        (Double)
                        {% elif tipo == 'object' %}
                        (Varchar)
                        {% elif tipo == 'datetime64[ns]' %}
                        (Datetime)
                        {% endif %}
                    </th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for row in datos %}
                <tr>
                    {% for value in row %}
                    <td>{{ value }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- BotÃ³n para crear una nueva tabla -->
        <button class="btn btn-success mb-3" onclick="mostrarFormulario()">Nueva Tabla</button>

        <!-- Formulario para crear una nueva tabla -->
        <div id="formulario-nueva-tabla" class="card p-4" style="display: none;">
            <button class="btn btn-danger mb-2" onclick="cerrarFormulario()">Cerrar</button>
            <h2>Crear Nueva Tabla</h2>
            <form method="post" action="{% url 'nueva_tabla' %}">
                {% csrf_token %}
                <div class="form-group">
                    <label for="nombre_tabla">Nombre de la nueva tabla:</label>
                    <input type="text" name="nombre_tabla" id="nombre_tabla" class="form-control">
                </div>
                <button type="submit" class="btn btn-primary">Crear Tabla</button>
            </form>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="{% static 'js/formulario.js' %}"></script>
</body>

</html>
